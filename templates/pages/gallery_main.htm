{% extends 'layout/gallery.htm' %}
{% block g_body %}

{% macro item_box(item) %}  
  
  {% if item.getClass == 'Album' %}
    {% set beginlink = '?album=' %}    
    {% set imagesrc = 'images/album.png' %}    
    {% set caption = item.getCaption %}     
    {% set link = '<a href = "'~beginlink~item.getPath~'">' %}     
  {% else %}
    {% set beginlink = 'loadDetail(\'?detail=' %}
    {% set endlink = '\');' %}
    {% set imagesrc = 'getimage.php?w=200&h=140&image='~item.getPath %}
    {% set caption = item.getCaption %}    
    {% set link = '<a href = "#" onclick="'~beginlink~item.getPath~endlink~'">' %}     
  {% endif %}
 
{{link | raw}}
<div class='box_item '>        
    <div class='box_image'>
       <img src='{{imagesrc}}'  />
    </div>
    <div class='box_caption'>
       {{caption}} 
    </div>
</div>
</a>    
{% endmacro %}


<div id="detail_content"></div>
<script type="text/javascript" src="js/load_detail.js"></script>

<div id='captionbar'>
<h1>{{gallery.getAlbum.caption}} :</h1>
</div>

{% if gallery.getAlbum.parent %}
<a href = "?album={{gallery.getAlbum.getParent.getPath}}">

<div class='box_item '>        
    <div class='box_image'>
       <img src='images/uplevel.png'  />
    </div>
    <div class='box_caption'>
       ../
    </div>
</div>

{% endif %}
{% for item in gallery.getItems %}      
  {{_self.item_box(item)}}
{% endfor %}


{% endblock %}